<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper의 namespace를 Mapper Interface로 지정해 준다. -->
<!-- namespace="mapper의 패키지 경로" / com.gdu.app10.mapper의 BoardMapper로 바꿔줘야함 -->
<mapper namespace="com.gdu.app12.mapper.BbsMapper">		<!-- mapper 패키지 상에서 동일한 인터페이스로 설정 -->

	<select id="selectAllBbsCount" resultType="int">
		SELECT COUNT(*)
		  FROM BBS
	</select>
	<!-- 
		원글 개수 : WHERE DEPTH = 0
		답글 개수 : WHERE GROUP_ORDER = 원글번호 AND DEPTH > 0
	 -->
	
	<select id="selectAllBbsList" parameterType="Map" resultType="BbsDTO">	<!-- ORDER BY BBS_NO DESC : 최신작성이 위로 -->
		SELECT A.RN, A.BBS_NO, A.WRITER, A.TITLE, A.IP, A.CREATE_DATE, A.STATE, A.DEPTH, A.GROUP_ORDER
		  FROM (SELECT ROW_NUMBER() OVER(ORDER BY BBS_NO DESC) AS RN, BBS_NO, WRITER, TITLE, IP, CREATE_DATE, STATE, DEPTH, GROUP_ORDER
		  		FROM BBS) A
		 WHERE A.RN BETWEEN #{begin} AND #{end}
	</select>
	
	<insert id="insertBbs" parameterType="BbsDTO"> 
	
	</insert>

	<update id="updatePreviousReply" parameterType="BbsDTO"> 
	
	</update>
	
	<insert id="insertReply" parameterType="BbsDTO"> 
	
	</insert>
	
	<update id="deleteBbs" parameterType="int"> 
		UPDATE BBS
		   SET STATE = 0
		 WHERE BBS_NO = #{bbsNo}
	</update>
	
	
</mapper>